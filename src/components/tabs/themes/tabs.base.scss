@use 'styles/common/component';
@use 'styles/utilities' as *;
@use 'tabs.common' as *;
@use 'sass:map';

$tabs-animation-function: cubic-bezier(.35, 0, .25, 1);
$arrow-start: 0;

:host {
    // Scroll buttons
    --scroll-btn-size: #{rem(48px)};
    --tabs-width: 100%;
    --tab-max-width: #{rem(360px)};
    --tab-min-width: #{rem(90px)};
    --_border-size: #{rem(1px)};

    display: block;
    overflow: hidden;
    position: relative;
    height: 100%;
}

%fake-column {
    content: '';
    width: 100%;
    height: 100%;
    grid-row: 1;
}

[part~='tabs'] {
    display: flex;
    overflow: hidden;
    height: 100%;

    /* stylelint-disable */
    -ms-overflow-style: none;
    /* stylelint-enable */

    overscroll-behavior: none;
    scrollbar-width: none;

    &::-webkit-scrollbar {
        display: none;
    }
}

// TODO: Move this in part tabs when scroll-padding is fixed.
// TODO: Add reference to the chromium browsers issue.
[part~='focused'] {
    scroll-padding-inline: var(--scroll-btn-size);
}

[part~='inner'] {
    display: grid;
    grid-template-rows: minmax(var(--header-min-height), auto) auto 1fr;
    align-items: center;
    position: relative;
    flex-grow: 1;

    ::slotted(igc-tab) {
        display: contents;
        pointer-events: none;
    }
}

[part~='scrollable'] {
    /* stylelint-disable */
    grid-template-columns: var(--scroll-btn-size) repeat(var(--tabs-count), minmax(max-content, auto)) var(--scroll-btn-size);
    /* stylelint-enable */
}

[part~='inner']:not([part~='scrollable']) {
    grid-template-columns: repeat(var(--tabs-count), minmax(auto, min-content));
    min-width: var(--tab-min-width);
}

:host([alignment='start']) {
    [part~='inner']:not([part~='scrollable']) {
        grid-template-columns: repeat(var(--tabs-count), minmax(max-content, auto)) 1fr;

        &::after {
            @extend %fake-column;
        }
    }
}

:host([alignment='center']) {
    [part~='inner']:not([part~='scrollable']) {
        grid-template-columns: 1fr repeat(var(--tabs-count), minmax(max-content, auto)) 1fr;

        &::before,
        &::after {
            @extend %fake-column;
        }
    }
}

:host([alignment='end']) {
    [part~='inner']:not([part~='scrollable']) {
        grid-template-columns: 1fr repeat(var(--tabs-count), minmax(max-content, auto));

        &::before {
            @extend %fake-column;
        }
    }
}

:host([alignment='justify']) {
    --tab-max-width--justify: 100%;

    [part~='scrollable'] {
        /* stylelint-disable */
        grid-template-columns: var(--scroll-btn-size) repeat(var(--tabs-count), minmax(var(--tab-min-width), 1fr)) var(--scroll-btn-size);
        /* stylelint-enable */
    }

    [part~='inner']:not([part~='scrollable']) {
        grid-template-columns: repeat(var(--tabs-count), minmax(var(--tab-min-width), auto));
    }
}

:host-context([dir='rtl']),
:host([dir='rtl']) {
    [part~='start-scroll-button'],
    [part~='end-scroll-button'] {
        transform: scaleX(-1);
    }
}

[part~='start-scroll-button'],
[part~='end-scroll-button'] {
    grid-row: 1;
    position: sticky;
    top: 0;
    height: 100%;
    min-width: var(--scroll-btn-size);
    width: var(--scroll-btn-size);
    z-index: map.get($tabs-z-index, 'scroll-button');
}

[part~='start-scroll-button'] {
    inset-inline-start: $arrow-start;
}

[part~='end-scroll-button'] {
    inset-inline-end: $arrow-start;
}

igc-icon-button::part(base) {
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 0;
    padding: 0;
    height: 100%;
    width: 100%;
    cursor: pointer;
}

[part='selected-indicator'] {
    position: relative;
    grid-row: 2;
    grid-column: 1 / -1;

    span {
        content: '';
        position: absolute;
        display: inline-block;
        transition: transform .3s $tabs-animation-function, width .2s $tabs-animation-function;
        z-index: map.get($tabs-z-index, 'selected-indicator');
    }
}
